<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Projeção de Banca</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #f4f6f9;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        padding: 0 10px;
      }

      h2 {
        font-size: 2rem;
        color: #333;
        margin-bottom: 20px;
      }

      #informativos,
      #informativos2 {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 20px;
        width: 90%;
        background-color: #fff;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .input-fields,
      .input-fields-2,
      .input-fields2,
      .input-fields-22 {
        display: flex;
        justify-content: space-between;
        width: 100%;
        max-width: 800px;
      }

      .input-x {
        display: flex;
        flex-direction: column;
        width: 100%;
        margin: 8px 0;
      }

      #informativos input,
      #informativos2 input {
        padding: 10px;
        font-size: 1rem;
        border-radius: 6px;
        border: 1px solid #ccc;
        width: 100%;
        max-width: 200px;
      }

      @media (max-width: 768px) {
        .input-fields,
        .input-fields-2,
        .input-fields2,
        .input-fields-22 {
          flex-direction: column;
          width: 100%;
          gap: 10px;
        }

        #informativos,
        #informativos2 {
          width: 100%;
        }
      }

      #informativos p,
      #informativos2 p {
        margin: 0;
        font-size: 1rem;
        color: #555;
      }

      #informativos input:focus,
      #informativos2 input:focus {
        border-color: #4e73df;
        outline: none;
      }

      .info p {
        margin-top: 15px;
      }

      #projectionTableWrapper,
      #projectionTableWrapper2 {
        width: 100%;
        max-width: 900px;
        height: 450px;
        overflow: auto;
        border-radius: 8px;
        background-color: #fff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        padding: 20px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        z-index: 1;
      }

      th,
      td {
        padding: 12px;
        text-align: center;
        font-size: 1rem;
        border: 1px solid #ddd;
      }

      th {
        background-color: #f7f7f7;
        color: #333;
        position: sticky;
        top: 0;
        z-index: 3;
      }

      tr.green-row {
        background-color: #d4edda !important;
        font-weight: bold !important;
      }

      .table-container {
        overflow-x: auto;
      }

      @media (max-width: 768px) {
        #informativos,
        #informativos2 {
          grid-template-columns: 1fr;
        }

        #projectionTableWrapper,
        #projectionTableWrapper2 {
          margin-top: 20px;
        }
      }
    </style>
  </head>
  <body>
    <h2>Projeção de Banca</h2>
    <div id="informativos">
      <div
        style="
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
        "
      >
        <div class="input-fields">
          <div class="input-x">
            <strong
              >Banca inicial: US$<span id="initialBankDisplay"></span
            ></strong>
            <input type="number" id="bankInput" value="15" />
          </div>
          <div class="input-x">
            <strong>Dias:</strong>
            <input type="number" id="daysInput" value="240" />
          </div>
          <div class="input-x">
            <strong>Operações:</strong>
            <input type="number" id="operationsInput" value="3" />
          </div>
        </div>
        <div class="input-fields-2">
          <div class="input-x">
            <strong>Ticks por operação:</strong>
            <input type="number" id="ticksInput" value="500" />
          </div>
          <div class="input-x">
            <strong>Meta:</strong>
            <input type="number" id="targetInput" value="200000.00" />
          </div>
          <div class="input-x">
            <strong>Valor da margem de 0.01 lote</strong>
            <input type="number" id="marginInput" value="13.12" />
          </div>
        </div>
      </div>
      <div style="width: 100%; display: flex; justify-content: center">
        <div
          style="
            display: flex;
            flex-direction: row;
            width: 800px;
            justify-content: space-between;
          "
        >
          <div>
            <p>
              <strong>Banca Final:</strong> <span id="finalBankValue"></span>
            </p>
            <p>
              <strong>% de Lucro Diário:</strong>
              <span id="dailyProfitPercentage"></span>%
            </p>
          </div>
          <div>
            <p><strong>Valor Máximo do Lote:</strong> 200.00</p>
            <p>
              <strong>Meta batida com:</strong>
              <span id="targetAchievedDay"></span> dias de operação.
            </p>
          </div>
        </div>
      </div>
    </div>

    <div id="projectionTableWrapper" class="table-container">
      <table id="projectionTable">
        <thead>
          <tr>
            <th>Dia</th>
            <th>Mês</th>
            <th>Banca Inicial</th>
            <th>Lucro do Dia</th>
            <th>Banca Total</th>
            <th>Meta %</th>
            <th>Lote</th>
            <th>Operações</th>
            <th>Ticks</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <h2>Projeção de Banca Mesa Proprietária</h2>
    <div id="informativos2">
      <div
        style="
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
        "
      >
        <div class="input-fields2">
          <div class="input-x">
            <strong
              >Banca inicial: US$<span id="initialBankDisplay2"></span
            ></strong>
            <input type="number" id="bankInput2" value="15" />
          </div>
          <div class="input-x">
            <strong>Dias:</strong>
            <input type="number" id="daysInput2" value="240" />
          </div>
          <div class="input-x">
            <strong>Operações:</strong>
            <input type="number" id="operationsInput2" value="3" />
          </div>
        </div>
        <div class="input-fields-22">
          <div class="input-x">
            <strong>Ticks por operação:</strong>
            <input type="number" id="ticksInput2" value="500" />
          </div>
          <div class="input-x">
            <strong>Meta:</strong>
            <input type="number" id="targetInput2" value="200000.00" />
          </div>
          <div class="input-x">
            <strong>Valor da margem de 0.01 lote</strong>
            <input type="number" id="marginInput2" value="13.12" />
          </div>
        </div>
      </div>
      <div style="width: 100%; display: flex; justify-content: center">
        <div
          style="
            display: flex;
            flex-direction: row;
            width: 800px;
            justify-content: space-between;
          "
        >
          <div>
            <p>
              <strong>Banca Final:</strong> <span id="finalBankValue2"></span>
            </p>
            <p>
              <strong>% de Lucro Diário:</strong>
              <span id="dailyProfitPercentage2"></span>%
            </p>
          </div>
          <div>
            <p><strong>Valor Máximo do Lote:</strong> 200.00</p>
            <p>
              <strong>Meta batida com:</strong>
              <span id="targetAchievedDay2"></span> dias de operação.
            </p>
          </div>
        </div>
      </div>
    </div>

    <div id="projectionTableWrapper2" class="table-container">
      <table id="projectionTable2">
        <thead>
          <tr>
            <th>Dia</th>
            <th>Mês</th>
            <th>Banca Inicial</th>
            <th>Lucro do Dia</th>
            <th>Banca Total</th>
            <th>Meta %</th>
            <th>Lote</th>
            <th>Operações</th>
            <th>Ticks</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <script>
      function generateProjection() {
        const bankInput = document.querySelector("#bankInput").value;
        const daysInput = document.querySelector("#daysInput").value;
        const operationsInput = document.querySelector("#operationsInput").value;
        const ticksInput = document.querySelector("#ticksInput").value;
        const targetInput = document.querySelector("#targetInput").value;
        const marginInput = document.querySelector("#marginInput").value;

        const bankInput2 = document.querySelector("#bankInput2").value;
        const daysInput2 = document.querySelector("#daysInput2").value;
        const operationsInput2 =
          document.querySelector("#operationsInput2").value;
        const ticksInput2 = document.querySelector("#ticksInput2").value;
        const targetInput2 = document.querySelector("#targetInput2").value;
        const marginInput2 = document.querySelector("#marginInput2").value;

        calculateProjection(
          bankInput,
          daysInput,
          operationsInput,
          ticksInput,
          targetInput,
          marginInput,
          "initialBankDisplay",
          "finalBankValue",
          "dailyProfitPercentage",
          "targetAchievedDay",
          "projectionTable"
        );

        calculateProjection(
          bankInput2,
          daysInput2,
          operationsInput2,
          ticksInput2,
          targetInput2,
          marginInput2,
          "initialBankDisplay2",
          "finalBankValue2",
          "dailyProfitPercentage2",
          "targetAchievedDay2",
          "projectionTable2"
        );
      }

      function calculateProjection(
        bankInput,
        daysInput,
        operationsInput,
        ticksInput,
        targetInput,
        marginInput,
        initialBankDisplayId,
        finalBankValueId,
        dailyProfitPercentageId,
        targetAchievedDayId,
        projectionTableId
      ) {
        const initialBank = parseFloat(bankInput);
        const days = parseInt(daysInput);
        const operationsPerDay = parseInt(operationsInput);
        const ticksPerOperation = parseInt(ticksInput);
        const targetValue = parseFloat(targetInput);
        const marginPerLot = parseFloat(marginInput);

        const dailyProfit = operationsPerDay * ticksPerOperation * 0.01;
        const dailyProfitPercentage = (dailyProfit / initialBank) * 100;

        document.querySelector(`#${initialBankDisplayId}`).textContent =
          initialBank.toFixed(2);
        document.querySelector(`#${dailyProfitPercentageId}`).textContent =
          dailyProfitPercentage.toFixed(2);

        const tableBody = document.querySelector(`#${projectionTableId} tbody`);
        tableBody.innerHTML = "";

        let bank = initialBank;
        let targetAchievedDay = null;
        let currentMonth = 0;

        for (let day = 1; day <= days; day++) {
          if (day % 20 === 1) {
            currentMonth++;
          }

          bank += dailyProfit;

          const row = document.createElement("tr");
          if (bank >= targetValue) {
            row.classList.add("green-row");
            if (!targetAchievedDay) {
              targetAchievedDay = day;
            }
          }

          const lotValue = Math.min(bank / marginPerLot, 200);

          row.innerHTML = `
            <td>${day}</td>
            <td>${currentMonth}</td>
            <td>${(bank - dailyProfit).toFixed(2)}</td>
            <td>${dailyProfit.toFixed(2)}</td>
            <td>${bank.toFixed(2)}</td>
            <td>${((bank / targetValue) * 100).toFixed(2)}</td>
            <td>${lotValue.toFixed(2)}</td>
            <td>${operationsPerDay}</td>
            <td>${ticksPerOperation}</td>
          `;

          tableBody.appendChild(row);
        }

        document.querySelector(`#${finalBankValueId}`).textContent =
          bank.toFixed(2);
        document.querySelector(`#${targetAchievedDayId}`).textContent =
          targetAchievedDay ?? "não alcançada";
      }

      document.querySelectorAll("input").forEach((input) => {
        input.addEventListener("input", generateProjection);
      });

      generateProjection();
    </script>
  </body>
</html>
