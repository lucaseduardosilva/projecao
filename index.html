<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Projeção de Banca</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.13/jspdf.plugin.autotable.min.js"></script>
  <style>
    :root {
      --primary: #4361ee;
      --primary-light: #c0c0c0;
      --primary-dark: #808080;
      --success: #4cc9f0;
      --success-light: #d4edda;
      --warning: #f8961e;
      --danger: #f94144;
      --light: #f8f9fa;
      --dark: #212529;
      --gray-100: #f8f9fa;
      --gray-200: #e9ecef;
      --gray-300: #dee2e6;
      --gray-400: #ced4da;
      --gray-500: #adb5bd;
      --gray-600: #6c757d;
      --gray-700: #495057;
      --gray-800: #343a40;
      --gray-900: #212529;
      --border-radius: 0.5rem;
      --box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.08);
      --transition: all 0.2s ease-in-out;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Inter", sans-serif;
      background-color: var(--gray-100);
      color: var(--gray-800);
      line-height: 1.5;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem 1rem;
      min-height: 100vh;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }

    h2 {
      font-size: 2rem;
      font-weight: 700;
      color: var(--gray-900);
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .card {
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      transition: var(--transition);
    }

    .card:hover {
      box-shadow: 0 0.75rem 1.5rem rgba(0, 0, 0, 0.1);
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    @media (min-width: 769px) {
      .input-grid {
        grid-template-columns: repeat(3, 1fr);
      }

      .input-group.larger-field {
        grid-column: span 1;
      }

      .input-group:nth-child(1),
      .input-group:nth-child(2),
      .input-group:nth-child(3) {
        grid-column: span 1;
      }

      .input-group:nth-child(4),
      .input-group:nth-child(5),
      .input-group:nth-child(6) {
        grid-column: span 1;
      }

      .input-group:nth-child(7),
      .input-group:nth-child(8),
      .input-group:nth-child(9) {
        grid-column: span 1;
      }
    }

    .input-group {
      display: flex;
      flex-direction: column;
    }

    .input-group label {
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--gray-700);
      font-size: 0.875rem;
    }

    .input-group input,
    .input-group select {
      padding: 0.75rem;
      border: 1px solid var(--gray-300);
      border-radius: var(--border-radius);
      font-size: 0.875rem;
      transition: var(--transition);
      color: var(--gray-800);
      background-color: white;
    }

    .input-group input:focus,
    .input-group select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.15);
    }

    .info-grid {
      display: flex;
      flex-direction: row;
      gap: 1.5rem;
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--gray-200);
    }

    @media (max-width: 768px) {
      .info-grid {
        flex-direction: column;
      }
    }

    .info-item {
      display: flex;
      flex-direction: column;
    }

    .info-item .label {
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--gray-600);
      margin-bottom: 0.25rem;
    }

    .info-item .value {
      font-weight: 700;
      font-size: 1.125rem;
      color: var(--gray-900);
    }

    .table-card {
      overflow: hidden;
      margin-bottom: 2rem;
    }

    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      background-color: var(--gray-100);
      border-bottom: 1px solid var(--gray-200);
    }

    .table-title {
      font-weight: 600;
      font-size: 1rem;
      color: var(--gray-800);
    }

    .export-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem 1rem;
      background-color: var(--primary);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      font-size: 0.875rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .export-btn:hover {
      background-color: var(--primary-dark);
    }

    .table-container {
      overflow-x: auto;
      max-height: 500px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th {
      background-color: var(--gray-100);
      color: var(--gray-700);
      font-weight: 600;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--gray-300);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    td {
      padding: 0.75rem 1rem;
      border-bottom: 1px solid var(--gray-200);
      font-size: 0.875rem;
      color: var(--gray-800);
    }

    tr:hover td {
      background-color: var(--gray-50);
    }

    tr.green-row {
      background-color: rgba(76, 201, 240, 0.1) !important;
    }

    tr.green-row td {
      font-weight: 600;
      color: var(--primary-dark);
    }

    tr.current-day-row td {
      background-color: rgba(67, 97, 238, 0.1) !important;
    }

    tr.passed-day-row td {
      background-color: var(--gray-50);
    }

    tr.passed-day-row td {
      color: var(--gray-800);
      background-color: var(--gray-50);
    }

    tr.last-passed-day-row td {
      background-color: white !important;
      font-weight: normal;
    }

    .info-item.period-info {
      display: none;
    }

    #loading {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
    }

    .loader {
      border: 5px solid #f3f3f3;
      border-top: 5px solid var(--primary);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 2s linear infinite;
      margin-bottom: 1rem;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .selected-row td {
      background-color: var(--primary-light) !important;
    }

    .operation-row {
      background-color: var(--gray-50);
    }

    .operation-row td {
      padding-left: 2rem;
      font-size: 0.75rem;
    }

    .language-selector {
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      gap: 16px;
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 100;
    }

    @media (max-width: 600px) {
      .language-selector {
        flex-direction: column;
        align-items: flex-end;
        gap: 16px;
      }
    }

    .language-btn {
      background-color: var(--primary);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      padding: 0.5rem 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .language-btn:hover {
      background-color: var(--primary-dark);
    }

    .language-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 0.5rem 0;
      min-width: 150px;
      display: none;
    }

    .language-dropdown.show {
      display: block;
    }

    .language-option {
      padding: 0.5rem 1rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .language-option:hover {
      background-color: var(--gray-100);
    }

    .language-option.active {
      background-color: var(--primary-light);
      color: var(--primary);
    }

    .flag {
      width: 20px;
      height: 15px;
      border-radius: 2px;
    }

    .theme-toggle-btn {
      background: var(--gray-200);
      color: var(--gray-800);
      border: none;
      border-radius: var(--border-radius);
      padding: 0.5rem 0.8rem;
      font-size: 1.1rem;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .theme-toggle-btn:hover {
      background: var(--primary-light);
    }

    body.dark-theme {
      background-color: #181A1B;
      color: #fff;
    }

    body.dark-theme .card,
    body.dark-theme .table-card {
      background-color: #23262A;
      color: #fff;
      box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.25);
    }

    body.dark-theme h2,
    body.dark-theme .table-title,
    body.dark-theme th {
      color: #fff;
    }

    body.dark-theme .input-group label,
    body.dark-theme .info-item .label {
      color: #bdbdbd;
    }

    body.dark-theme .input-group input,
    body.dark-theme .input-group select {
      background-color: #23262A;
      color: #fff;
      border: 1px solid #333;
    }

    body.dark-theme .input-group input:focus,
    body.dark-theme .input-group select:focus {
      border-color: #4cc9f0;
      box-shadow: 0 0 0 3px rgba(76, 201, 240, 0.15);
    }

    body.dark-theme .export-btn,
    body.dark-theme .language-btn,
    body.dark-theme .theme-toggle-btn {
      background-color: #23262A;
      color: #fff;
      border: 1px solid #333;
    }

    body.dark-theme .export-btn:hover,
    body.dark-theme .language-btn:hover,
    body.dark-theme .theme-toggle-btn:hover {
      background-color: #181A1B;
    }

    body.dark-theme .language-dropdown {
      background-color: #23262A;
      color: #fff;
      box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.25);
    }

    body.dark-theme .language-option {
      color: #fff;
    }

    body.dark-theme .language-option.active {
      background-color: #181A1B;
      color: #4cc9f0;
    }

    body.dark-theme th {
      background-color: #23262A;
      color: #bdbdbd;
    }

    body.dark-theme td {
      color: #fff;
      background-color: #23262A;
    }

    body.dark-theme tr.green-row td {
      background-color: #22336b !important;
      color: #fff;
    }

    body.dark-theme tr.current-day-row td {
      background-color: #222b3a !important;
    }

    body.dark-theme tr.passed-day-row td,
    body.dark-theme tr.last-passed-day-row td {
      background-color: #23262A !important;
      color: #bdbdbd;
    }

    body.dark-theme .operation-row td {
      background-color: #23262A !important;
      color: #bdbdbd;
    }

    body.dark-theme .info-item .value {
      color: #fff;
    }

    body.dark-theme .loader {
      border: 5px solid #23262A;
      border-top: 5px solid #4cc9f0;
    }

    body.dark-theme .table-header {
      background-color: #23262A;
      border-bottom: 1px solid #333;
    }

    body.dark-theme .table-container {
      background-color: #23262A;
    }
  </style>
</head>

<body>
  <div class="language-selector">
    <button class="theme-toggle-btn" id="themeToggleBtn" onclick="toggleTheme()" title="Alternar tema">
      <span id="themeIcon">🌙</span>
    </button>
    <button class="language-btn" onclick="toggleLanguageDropdown()">
      <span class="flag">🇧🇷</span>
      <span id="currentLanguage">Português</span>
      <span>▼</span>
    </button>
    <div class="language-dropdown" id="languageDropdown">
      <div class="language-option active" data-lang="pt" onclick="changeLanguage('pt')">
        <span class="flag">🇧🇷</span>
        <span>Português</span>
      </div>
      <div class="language-option" data-lang="en" onclick="changeLanguage('en')">
        <span class="flag">🇺🇸</span>
        <span>English</span>
      </div>
      <div class="language-option" data-lang="es" onclick="changeLanguage('es')">
        <span class="flag">🇪🇸</span>
        <span>Español</span>
      </div>
      <div class="language-option" data-lang="fr" onclick="changeLanguage('fr')">
        <span class="flag">🇫🇷</span>
        <span>Français</span>
      </div>
      <div class="language-option" data-lang="de" onclick="changeLanguage('de')">
        <span class="flag">🇩🇪</span>
        <span>Deutsch</span>
      </div>
      <div class="language-option" data-lang="it" onclick="changeLanguage('it')">
        <span class="flag">🇮🇹</span>
        <span>Italiano</span>
      </div>
      <div class="language-option" data-lang="ru" onclick="changeLanguage('ru')">
        <span class="flag">🇷🇺</span>
        <span>Русский</span>
      </div>
      <div class="language-option" data-lang="zh" onclick="changeLanguage('zh')">
        <span class="flag">🇨🇳</span>
        <span>中文</span>
      </div>
    </div>
  </div>

  <div id="loading">
    <div class="loader"></div>
    <span id="loadingText">Carregando...</span>
  </div>

  <div class="container">
    <h2 id="mainTitle">Projeção de Banca</h2>

    <div class="card">
      <div class="input-grid">
        <div class="input-group">
          <label for="bankInput" id="bankLabel">Banca inicial (US$)</label>
          <input type="number" id="bankInput" value="2" />
        </div>
        <div class="input-group">
          <label for="daysInput" id="daysLabel">Dias</label>
          <input type="number" id="daysInput" value="210" />
        </div>
        <div class="input-group">
          <label for="operationsInput" id="operationsLabel">Operações</label>
          <input type="number" id="operationsInput" value="1" />
        </div>
        <div class="input-group">
          <label for="moeda" id="currencyLabel">Moeda</label>
          <select name="moeda" id="moeda">
            <option value="XAUUSD">XAUUSD</option>
          </select>
        </div>
        <div class="input-group">
          <label for="ticksInput" id="ticksLabel">Ticks por operação</label>
          <input type="number" id="ticksInput" value="500" />
        </div>
        <div class="input-group">
          <label for="targetInput" id="targetLabel">Meta (US$)</label>
          <input type="number" id="targetInput" value="200000.00" />
        </div>
        <div class="input-group larger-field">
          <label for="marginInput" id="marginLabel">Margem de 0.01 lote</label>
          <input type="number" id="marginInput" value="" step="0.01" />
        </div>
        <div class="input-group larger-field">
          <label for="lotes" id="lotsLabel">Lotes</label>
          <input type="number" id="lotes" value="250" />
        </div>
        <div class="input-group larger-field">
          <label for="recalculateOperationsInput" id="recalculateLabel">Recalcular a cada (operações)</label>
          <input type="number" id="recalculateOperationsInput" value="1" min="1" />
        </div>
      </div>

      <div class="info-grid">
        <div class="info-item period-info" style="display: none;">
          <span class="label" id="periodLabel">Período</span>
          <span class="value">10/03/2025 até 19/12/2025</span>
        </div>
        <div class="info-item">
          <span class="label" id="finalBankLabel">Banca Final</span>
          <span class="value" id="finalBankValue">$0.00</span>
        </div>
        <div class="info-item">
          <span class="label" id="targetAchievedLabel">Meta batida com</span>
          <span class="value" id="targetAchievedDay">0 dias</span>
        </div>
      </div>
    </div>

    <div class="card table-card">
      <div class="table-header">
        <h3 class="table-title" id="tableTitle">Projeção Diária</h3>
        <button id="card-table-button" class="export-btn" onclick="exportToPDF()">
          <span id="exportButtonText">Exportar para PDF</span>
        </button>
      </div>
      <div class="table-container" id="projectionTableWrapper">
        <table id="projectionTable">
          <thead>
            <tr>
              <th id="dayHeader">Dia</th>
              <th id="initialBankHeader">Banca Inicial</th>
              <th id="dailyProfitHeader">Lucro do Dia</th>
              <th id="profitPerOperationHeader">Lucro por Operação</th>
              <th id="totalBankHeader">Banca Total</th>
              <th id="totalBankBrlHeader">Banca Total (BRL)</th>
              <th id="targetPercentageHeader">Meta %</th>
              <th id="operationsHeader">Operações</th>
              <th id="lotHeader">Lote</th>
              <th id="ticksHeader">Ticks</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    const targetInputElement = document.getElementById("targetInput");
    const marginInput = document.querySelector("#marginInput");
    const ticksInput = document.querySelector("#ticksInput");
    const lotesInput = document.querySelector("#lotes");
    const moedaSelect = document.querySelector("#moeda");
    const bankInput = document.querySelector("#bankInput");
    const recalculateOperationsInput = document.querySelector("#recalculateOperationsInput");

    let usdToBrlRate = 0;
    let defaultMarginValue = 1.49;
    let originalTicksValue = 500;
    let xauusdValues = {};
    let selectedRows = new Set();
    let currentLanguage = 'pt';

    const translations = {
      pt: {
        mainTitle: "Projeção de Banca",
        bankLabel: "Banca inicial (US$)",
        daysLabel: "Dias",
        operationsLabel: "Operações",
        currencyLabel: "Moeda",
        ticksLabel: "Ticks por operação",
        targetLabel: "Meta (US$)",
        marginLabel: "Margem de 0.01 lote",
        lotsLabel: "Lotes",
        recalculateLabel: "Recalcular a cada (operações)",
        periodLabel: "Período",
        finalBankLabel: "Banca Final",
        targetAchievedLabel: "Meta batida com",
        tableTitle: "Projeção Diária",
        exportButtonText: "Exportar para PDF",
        dayHeader: "Dia",
        initialBankHeader: "Banca Inicial",
        dailyProfitHeader: "Lucro do Dia",
        profitPerOperationHeader: "Lucro por Operação",
        totalBankHeader: "Banca Total",
        totalBankBrlHeader: "Banca Total (BRL)",
        targetPercentageHeader: "Meta %",
        operationsHeader: "Operações",
        lotHeader: "Lote",
        ticksHeader: "Ticks",
        loadingText: "Carregando...",
        operationText: "Operação",
        totalText: "Total",
        targetNotAchieved: "Meta não atingida",
        daysOfOperation: "dias de operação"
      },
      en: {
        mainTitle: "Bank Projection",
        bankLabel: "Initial Bank (US$)",
        daysLabel: "Days",
        operationsLabel: "Operations",
        currencyLabel: "Currency",
        ticksLabel: "Ticks per operation",
        targetLabel: "Target (US$)",
        marginLabel: "Margin for 0.01 lot",
        lotsLabel: "Lots",
        recalculateLabel: "Recalculate every (operations)",
        periodLabel: "Period",
        finalBankLabel: "Final Bank",
        targetAchievedLabel: "Target achieved with",
        tableTitle: "Daily Projection",
        exportButtonText: "Export to PDF",
        dayHeader: "Day",
        initialBankHeader: "Initial Bank",
        dailyProfitHeader: "Daily Profit",
        profitPerOperationHeader: "Profit per Operation",
        totalBankHeader: "Total Bank",
        totalBankBrlHeader: "Total Bank (BRL)",
        targetPercentageHeader: "Target %",
        operationsHeader: "Operations",
        lotHeader: "Lot",
        ticksHeader: "Ticks",
        loadingText: "Loading...",
        operationText: "Operation",
        totalText: "Total",
        targetNotAchieved: "Target not achieved",
        daysOfOperation: "days of operation"
      },
      es: {
        mainTitle: "Proyección de Banca",
        bankLabel: "Banca inicial (US$)",
        daysLabel: "Días",
        operationsLabel: "Operaciones",
        currencyLabel: "Moneda",
        ticksLabel: "Ticks por operación",
        targetLabel: "Meta (US$)",
        marginLabel: "Margen de 0.01 lote",
        lotsLabel: "Lotes",
        recalculateLabel: "Recalcular cada (operaciones)",
        periodLabel: "Período",
        finalBankLabel: "Banca Final",
        targetAchievedLabel: "Meta alcanzada con",
        tableTitle: "Proyección Diaria",
        exportButtonText: "Exportar a PDF",
        dayHeader: "Día",
        initialBankHeader: "Banca Inicial",
        dailyProfitHeader: "Beneficio Diario",
        profitPerOperationHeader: "Beneficio por Operación",
        totalBankHeader: "Banca Total",
        totalBankBrlHeader: "Banca Total (BRL)",
        targetPercentageHeader: "Meta %",
        operationsHeader: "Operaciones",
        lotHeader: "Lote",
        ticksHeader: "Ticks",
        loadingText: "Cargando...",
        operationText: "Operación",
        totalText: "Total",
        targetNotAchieved: "Meta no alcanzada",
        daysOfOperation: "días de operación"
      },
      fr: {
        mainTitle: "Projection de Banque",
        bankLabel: "Banque initiale (US$)",
        daysLabel: "Jours",
        operationsLabel: "Opérations",
        currencyLabel: "Devise",
        ticksLabel: "Ticks par opération",
        targetLabel: "Objectif (US$)",
        marginLabel: "Marge pour 0.01 lot",
        lotsLabel: "Lots",
        recalculateLabel: "Recalculer tous les (opérations)",
        periodLabel: "Période",
        finalBankLabel: "Banque Finale",
        targetAchievedLabel: "Objectif atteint avec",
        tableTitle: "Projection Quotidienne",
        exportButtonText: "Exporter en PDF",
        dayHeader: "Jour",
        initialBankHeader: "Banque Initiale",
        dailyProfitHeader: "Bénéfice Quotidien",
        profitPerOperationHeader: "Bénéfice par Opération",
        totalBankHeader: "Banque Totale",
        totalBankBrlHeader: "Banque Totale (BRL)",
        targetPercentageHeader: "Objectif %",
        operationsHeader: "Opérations",
        lotHeader: "Lot",
        ticksHeader: "Ticks",
        loadingText: "Chargement...",
        operationText: "Opération",
        totalText: "Total",
        targetNotAchieved: "Objectif non atteint",
        daysOfOperation: "jours d'opération"
      },
      de: {
        mainTitle: "Bank-Projektion",
        bankLabel: "Anfangsbank (US$)",
        daysLabel: "Tage",
        operationsLabel: "Operationen",
        currencyLabel: "Währung",
        ticksLabel: "Ticks pro Operation",
        targetLabel: "Ziel (US$)",
        marginLabel: "Marge für 0.01 Lot",
        lotsLabel: "Lots",
        recalculateLabel: "Neu berechnen alle (Operationen)",
        periodLabel: "Zeitraum",
        finalBankLabel: "Endbank",
        targetAchievedLabel: "Ziel erreicht mit",
        tableTitle: "Tägliche Projektion",
        exportButtonText: "Als PDF exportieren",
        dayHeader: "Tag",
        initialBankHeader: "Anfangsbank",
        dailyProfitHeader: "Tagesgewinn",
        profitPerOperationHeader: "Gewinn pro Operation",
        totalBankHeader: "Gesamtbank",
        totalBankBrlHeader: "Gesamtbank (BRL)",
        targetPercentageHeader: "Ziel %",
        operationsHeader: "Operationen",
        lotHeader: "Lot",
        ticksHeader: "Ticks",
        loadingText: "Laden...",
        operationText: "Operation",
        totalText: "Gesamt",
        targetNotAchieved: "Ziel nicht erreicht",
        daysOfOperation: "Handelstage"
      },
      it: {
        mainTitle: "Proiezione Banca",
        bankLabel: "Banca iniziale (US$)",
        daysLabel: "Giorni",
        operationsLabel: "Operazioni",
        currencyLabel: "Valuta",
        ticksLabel: "Ticks per operazione",
        targetLabel: "Obiettivo (US$)",
        marginLabel: "Margine per 0.01 lotto",
        lotsLabel: "Lotti",
        recalculateLabel: "Ricalcola ogni (operazioni)",
        periodLabel: "Periodo",
        finalBankLabel: "Banca Finale",
        targetAchievedLabel: "Obiettivo raggiunto con",
        tableTitle: "Proiezione Giornaliera",
        exportButtonText: "Esporta in PDF",
        dayHeader: "Giorno",
        initialBankHeader: "Banca Iniziale",
        dailyProfitHeader: "Profitto Giornaliero",
        profitPerOperationHeader: "Profitto per Operazione",
        totalBankHeader: "Banca Totale",
        totalBankBrlHeader: "Banca Totale (BRL)",
        targetPercentageHeader: "Obiettivo %",
        operationsHeader: "Operazioni",
        lotHeader: "Lotto",
        ticksHeader: "Ticks",
        loadingText: "Caricamento...",
        operationText: "Operazione",
        totalText: "Totale",
        targetNotAchieved: "Obiettivo non raggiunto",
        daysOfOperation: "giorni di operazione"
      },
      ru: {
        mainTitle: "Проекция Банка",
        bankLabel: "Начальный банк (US$)",
        daysLabel: "Дни",
        operationsLabel: "Операции",
        currencyLabel: "Валюта",
        ticksLabel: "Тики за операцию",
        targetLabel: "Цель (US$)",
        marginLabel: "Маржа для 0.01 лота",
        lotsLabel: "Лоты",
        recalculateLabel: "Пересчитывать каждые (операции)",
        periodLabel: "Период",
        finalBankLabel: "Финальный банк",
        targetAchievedLabel: "Цель достигнута за",
        tableTitle: "Ежедневная проекция",
        exportButtonText: "Экспорт в PDF",
        dayHeader: "День",
        initialBankHeader: "Начальный банк",
        dailyProfitHeader: "Дневная прибыль",
        profitPerOperationHeader: "Прибыль за операцию",
        totalBankHeader: "Общий банк",
        totalBankBrlHeader: "Общий банк (BRL)",
        targetPercentageHeader: "Цель %",
        operationsHeader: "Операции",
        lotHeader: "Лот",
        ticksHeader: "Тики",
        loadingText: "Загрузка...",
        operationText: "Операция",
        totalText: "Итого",
        targetNotAchieved: "Цель не достигнута",
        daysOfOperation: "дней торговли"
      },
      zh: {
        mainTitle: "银行预测",
        bankLabel: "初始资金 (US$)",
        daysLabel: "天数",
        operationsLabel: "操作",
        currencyLabel: "货币",
        ticksLabel: "每次操作点数",
        targetLabel: "目标 (US$)",
        marginLabel: "0.01手保证金",
        lotsLabel: "手数",
        recalculateLabel: "每(操作)重新计算",
        periodLabel: "期间",
        finalBankLabel: "最终资金",
        targetAchievedLabel: "目标达成于",
        tableTitle: "每日预测",
        exportButtonText: "导出为PDF",
        dayHeader: "天",
        initialBankHeader: "初始资金",
        dailyProfitHeader: "日利润",
        profitPerOperationHeader: "每次操作利润",
        totalBankHeader: "总资金",
        totalBankBrlHeader: "总资金 (BRL)",
        targetPercentageHeader: "目标%",
        operationsHeader: "操作",
        lotHeader: "手",
        ticksHeader: "点数",
        loadingText: "加载中...",
        operationText: "操作",
        totalText: "总计",
        targetNotAchieved: "目标未达成",
        daysOfOperation: "个交易日"
      }
    };

    function exportToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const convertForPDF = (text) => {
        if (currentLanguage === 'ru') {
          const russianMap = { 'Проекция Банка': 'Bank Projection', 'Начальный банк': 'Initial Bank', 'Дни': 'Days', 'Операции': 'Operations', 'Валюта': 'Currency', 'Тики за операцию': 'Ticks per operation', 'Цель': 'Target', 'Маржа для 0.01 лота': 'Margin for 0.01 lot', 'Лоты': 'Lots', 'Пересчитывать каждые': 'Recalculate every', 'Период': 'Period', 'Финальный банк': 'Final Bank', 'Цель достигнута за': 'Target achieved with', 'Ежедневная проекция': 'Daily Projection', 'Экспорт в PDF': 'Export to PDF', 'День': 'Day', 'Дневная прибыль': 'Daily Profit', 'Прибыль за операцию': 'Profit per Operation', 'Общий банк': 'Total Bank', 'Общий банк (BRL)': 'Total Bank (BRL)', 'Цель %': 'Target %', 'Лот': 'Lot', 'Тики': 'Ticks', 'Загрузка': 'Loading', 'Операция': 'Operation', 'Цель не достигнута': 'Target not achieved', 'дней торговли': 'trading days' };
          return russianMap[text] || text;
        } else if (currentLanguage === 'zh') {
          const chineseMap = { '银行预测': 'Bank Projection', '初始资金': 'Initial Bank', '天数': 'Days', '操作': 'Operations', '货币': 'Currency', '每次操作点数': 'Ticks per operation', '目标': 'Target', '0.01手保证金': 'Margin for 0.01 lot', '手数': 'Lots', '每(操作)重新计算': 'Recalculate every (operations)', '期间': 'Period', '最终资金': 'Final Bank', '目标达成于': 'Target achieved with', '每日预测': 'Daily Projection', '导出为PDF': 'Export to PDF', '天': 'Day', '日利润': 'Daily Profit', '每次操作利润': 'Profit per Operation', '总资金': 'Total Bank', '总资金 (BRL)': 'Total Bank (BRL)', '目标%': 'Target %', '手': 'Lot', '点数': 'Ticks', '加载中': 'Loading', '操作': 'Operation', '目标未达成': 'Target not achieved', '个交易日': 'trading days' };
          return chineseMap[text] || text;
        }
        return text;
      };

      const t = translations[currentLanguage];
      const moeda = document.querySelector("#moeda").value;
      const lotes = parseFloat(document.querySelector("#lotes").value);
      const initialBank = parseFloat(document.querySelector("#bankInput").value);
      const days = parseInt(document.querySelector("#daysInput").value);
      const operationsPerDay = parseInt(document.querySelector("#operationsInput").value);
      const targetValue = parseFloat(document.querySelector("#targetInput").value);
      let ticksPerOperation = moeda === 'USDJPY' ? (originalTicksValue / 10).toFixed(0) : originalTicksValue;
      const targetDay = document.querySelector("#targetAchievedDay").textContent;
      const marginValue = parseFloat(marginInput.value);
      const recalculateOperations = parseInt(recalculateOperationsInput.value);
      const finalBank = document.querySelector("#finalBankValue").textContent;

      doc.setFontSize(10);
      doc.text(`${convertForPDF(t.bankLabel)} ${initialBank.toFixed(2)}`, 10, 10);
      doc.text(`${convertForPDF(t.daysLabel)} ${days}`, 10, 20);
      doc.text(`${convertForPDF(t.operationsLabel)} ${operationsPerDay}`, 10, 30);
      doc.text(`${convertForPDF(t.ticksLabel)} ${ticksPerOperation}`, 10, 40);
      doc.text(`${convertForPDF(t.targetLabel)} ${targetValue.toFixed(2)}`, 10, 50);
      doc.text(`${convertForPDF(t.marginLabel)} ${marginValue.toFixed(2)}`, 10, 60);
      doc.text(`${convertForPDF(t.currencyLabel)} ${moeda}`, 10, 70);
      doc.text(`${convertForPDF(t.recalculateLabel)} ${recalculateOperations}`, 10, 80);
      doc.text(`${convertForPDF(t.targetAchievedLabel)} ${targetDay}`, 10, 90);
      doc.text(`${convertForPDF(t.finalBankLabel)} ${finalBank}`, 10, 100);

      const table = document.getElementById("projectionTable");
      const headers = [
        convertForPDF(t.dayHeader),
        convertForPDF(t.initialBankHeader),
        convertForPDF(t.dailyProfitHeader),
        convertForPDF(t.profitPerOperationHeader),
        convertForPDF(t.totalBankHeader),
        convertForPDF(t.totalBankBrlHeader),
        convertForPDF(t.targetPercentageHeader),
        convertForPDF(t.operationsHeader),
        convertForPDF(t.lotHeader),
        convertForPDF(t.ticksHeader)
      ];

      const rows = Array.from(table.querySelectorAll("tbody tr")).map(tr =>
        Array.from(tr.children).map(td => td.textContent)
      );

      doc.autoTable({
        head: [headers],
        body: rows,
        startY: 120,
        styles: { fontSize: 8 },
      });

      doc.save("projection.pdf");
    }

    async function fetchMargin(instrument) {
      try {
        let accountType = "mt5_classic_real_vc";
        if (instrument === "USDJPY") {
          accountType = "mt5_zero_real_vc";
        }
        const response = await fetch("https://www.exness.com/pwapi/", {
          method: "POST",
          headers: {
            accept: "*/*", "accept-language": "pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7", "content-type": "application/json",
          },
          body: JSON.stringify({
            operationName: "Calculate",
            variables: { input: { account_type: accountType, instrument: instrument, currency: "USD", leverage: 2000, lot: 0.01, }, },
            query: "mutation Calculate($input: CalculationInput!) {\n  calculate(input: $input) {\n    currency\n    margin\n    pip_value\n    swap_long\n    swap_short\n    spread\n    commission\n    __typename\n  }\n}",
          }),
        });
        if (!response.ok) { console.error(`HTTP error! status: ${response.status}`); return null; }
        const data = await response.json();
        if (data && data.data && data.data.calculate) { return parseFloat(data.data.calculate.margin).toFixed(2); }
        else { console.error("Unexpected API response:", data); return null; }
      } catch (error) { console.error("Error fetching margin:", error); return null; }
    }

    async function generateProjection() {
      showLoading();
      try {
        const moeda = document.querySelector("#moeda").value;
        const lotes = parseFloat(document.querySelector("#lotes").value);
        let initialBank = parseFloat(document.querySelector("#bankInput").value);
        const days = parseInt(document.querySelector("#daysInput").value);
        const operationsPerDay = parseInt(document.querySelector("#operationsInput").value);
        const targetValue = parseFloat(document.querySelector("#targetInput").value);
        const tickValue = moeda === "XAUUSD" ? 0.1 : 0.01;
        const marginValue = parseFloat(marginInput.value);
        let ticksPerOperation = originalTicksValue;
        let bank = initialBank;
        const maxLotValue = lotes;
        const recalculateOperations = parseInt(recalculateOperationsInput.value) || 1;

        let currentLotValue = 0.01;
        let operationsCounter = 0;
        let currentMonth = 1;
        const tableBody = document.querySelector("#projectionTable tbody");
        tableBody.innerHTML = "";
        let greenRowAdded = false;
        let targetAchievedDay = null;

        const startDate = new Date("2025-04-22T00:00:00");
        const endDate = new Date("2100-12-18T00:00:00");
        let businessDays = 0;
        let currentDate = new Date(startDate);
        let dayCounter = 1;
        let today = new Date();
        let lastPassedDay = null;
        let daysWithCheckmark = 0;
        let lastDayBank = initialBank;

        while (currentDate <= endDate && dayCounter <= days) {
          const dayOfWeek = currentDate.getDay();
          if (dayOfWeek !== 0 && dayOfWeek !== 6) {

            operationsCounter = 0;
            bank = lastDayBank;
            let dailyProfit = 0;
            const dayInitialBank = bank;
            let lotUsedFirstOperation = 0.01;
            let lotUsedLastOperation = 0.01;
            let profitFirstOperation = 0;
            let profitLastOperation = 0;

            const row = document.createElement("tr");
            row.dataset.day = dayCounter;

            row.addEventListener('click', () => {
              const day = row.dataset.day;
              if (selectedRows.has(day)) {
                selectedRows.delete(day);
                row.classList.remove('selected-row');
                document.querySelectorAll(`tr[data-parent-day="${day}"]`).forEach(el => el.remove());
              } else {
                selectedRows.add(day);
                row.classList.add('selected-row');
                let currentBank = dayInitialBank;

                const operationRows = [];
                let totalProfit = 0;
                const t = translations[currentLanguage];

                for (let op = 1; op <= operationsPerDay; op++) {
                  const operationRow = document.createElement("tr");
                  operationRow.classList.add("operation-row");
                  operationRow.dataset.parentDay = day;

                  let operationLotValue = 0.01;
                  let maxPossibleLot = Math.floor(currentBank / marginValue) * 0.01;
                  operationLotValue = Math.max(0.01, Math.min(maxLotValue, maxPossibleLot));

                  const operationProfit = ticksPerOperation * tickValue * operationLotValue;
                  currentBank += operationProfit;
                  totalProfit += operationProfit;
                  operationRow.innerHTML = `
                      <td style="background-color: #f2f2f2;">${t.operationText} ${op}</td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;">${operationProfit.toFixed(2)}</td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;">${operationLotValue.toFixed(2)}</td>
                      <td style="background-color: #f2f2f2;">${ticksPerOperation}</td>
                  `;
                  operationRows.push(operationRow);
                }

                if (operationsPerDay > 1) {
                  const totalRow = document.createElement("tr");
                  totalRow.classList.add("operation-row");
                  totalRow.dataset.parentDay = day;
                  totalRow.innerHTML = `
                      <td style="background-color: #f2f2f2;">${t.totalText}</td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;">${totalProfit.toFixed(2)}</td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                      <td style="background-color: #f2f2f2;"></td>
                  `;
                  operationRows.push(totalRow);
                }

                for (let i = operationRows.length - 1; i >= 0; i--) {
                  tableBody.insertBefore(operationRows[i], row.nextSibling);
                }
              }
            });

            if (!greenRowAdded && bank >= targetValue) {
              row.classList.add("green-row");
              greenRowAdded = true;
              targetAchievedDay = dayCounter;
            }

            const formatDate = (date) => {
              const year = date.getFullYear();
              const month = String(date.getMonth() + 1).padStart(2, "0");
              const day = String(date.getDate()).padStart(2, "0");
              return `${day}/${month}/${year}`;
            };

            const formattedDate = formatDate(currentDate);
            if (currentDate < today) {
              row.classList.add("passed-day-row");
              lastPassedDay = { row: row, day: dayCounter };
              daysWithCheckmark++;
            }

            if (formatDate(currentDate) === formatDate(today) && !greenRowAdded) {
              row.classList.add("current-day-row");
            }

            let dayDisplay = dayCounter;
            let dailyProfitValue = 0;

            for (let op = 1; op <= operationsPerDay; op++) {
              let maxPossibleLot = Math.floor(bank / marginValue) * 0.01;
              let lotUsed = Math.max(0.01, Math.min(maxLotValue, maxPossibleLot));
              const operationProfit = ticksPerOperation * tickValue * lotUsed;
              bank += operationProfit;
              dailyProfitValue += operationProfit;

              if (op === 1) {
                lotUsedFirstOperation = lotUsed;
                profitFirstOperation = operationProfit;
              }
              if (op === operationsPerDay) {
                lotUsedLastOperation = lotUsed;
                profitLastOperation = operationProfit;
              }
            }

            let profitPerOperation = profitFirstOperation.toFixed(2);
            if (profitFirstOperation !== profitLastOperation) {
              profitPerOperation += " até " + profitLastOperation.toFixed(2);
            }
            const ticksDisplay = moeda === 'USDJPY' ? (ticksPerOperation / 10).toFixed(0) : ticksPerOperation;
            const dailyPercentage = (dailyProfitValue / dayInitialBank) * 100;
            const bankInBrl = bank * usdToBrlRate;

            let lotRange = lotUsedFirstOperation.toFixed(2);
            if (lotUsedFirstOperation !== lotUsedLastOperation) {
              lotRange += " até " + lotUsedLastOperation.toFixed(2);
            }

            row.innerHTML = `
                <td>${dayDisplay}</td>
                <td>${dayInitialBank.toFixed(2)}</td>
                <td>${dailyProfitValue.toFixed(2)}</td>
                <td>${profitPerOperation}</td>
                <td>${bank.toFixed(2)}</td>
                <td>${bankInBrl.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                <td>${dailyPercentage.toFixed(2)}%</td>
                <td>${operationsPerDay}</td>
                <td>${lotRange}</td>
                <td>${ticksDisplay}</td>
              `;

            tableBody.appendChild(row);
            businessDays++;
            dayCounter++;
            lastDayBank = bank;
          }
          currentDate.setDate(currentDate.getDate() + 1);

          if (dayCounter % 20 === 1 && dayCounter !== 1) {
            currentMonth += 1;
          }
        }

        if (lastPassedDay) {
          lastPassedDay.row.classList.remove("passed-day-row");
          lastPassedDay.row.classList.add("last-passed-day-row");
          lastPassedDay.row.querySelector("td:first-child").textContent = lastPassedDay.day;
        }

        const formattedBankValue = new Intl.NumberFormat("en-US", { style: "currency", currency: "USD", }).format(bank);
        document.querySelector("#finalBankValue").textContent = formattedBankValue;
        const t = translations[currentLanguage];
        document.querySelector("#targetAchievedDay").textContent =
          targetAchievedDay ? `${targetAchievedDay} ${t.daysOfOperation}` : t.targetNotAchieved;

      } finally {
        hideLoading();
      }
    }

    async function fetchDollarRate() {
      try {
        const response = await fetch("https://economia.awesomeapi.com.br/json/last/USD-BRL");
        const data = await response.json();
        if (data.USDBRL && data.USDBRL.ask) {
          usdToBrlRate = parseFloat(data.USDBRL.ask);
        }
        const high = parseFloat(data.USDBRL.high);
        const low = parseFloat(data.USDBRL.low);
        const average = (high + low) / 2;
        const targetValue = 1000000 / average;
        document.querySelector("#targetInput").value = targetValue.toFixed(2);
      } catch (error) {
        console.error("Erro ao buscar a cotação do dólar:", error);
        usdToBrlRate = 5.25; // Fallback
      }
    }

    function showLoading() { document.getElementById("loading").style.display = "flex"; }
    function hideLoading() { document.getElementById("loading").style.display = "none"; }

    moedaSelect.addEventListener("change", async () => {
      showLoading();
      try {
        const selectedMoeda = moedaSelect.value;
        let ticksValue = 500;
        if (selectedMoeda === "XAUUSD") {
          ticksValue = 500;
          lotesInput.value = 200;
          if (xauusdValues.bankInput) {
            bankInput.value = xauusdValues.bankInput;
            ticksInput.value = xauusdValues.ticksInput;
            marginInput.value = xauusdValues.marginInput;
            originalTicksValue = xauusdValues.originalTicksValue;
          }
        } else if (selectedMoeda === "USDJPY") {
          xauusdValues.bankInput = bankInput.value;
          xauusdValues.ticksInput = ticksInput.value;
          xauusdValues.marginInput = marginInput.value;
          xauusdValues.originalTicksValue = originalTicksValue;
          ticksValue = 20000;
          lotesInput.value = 200;
          bankInput.value = 1;
        }
        originalTicksValue = ticksValue;
        ticksInput.value = selectedMoeda === "USDJPY" ? ticksValue / 10 : ticksValue;
        const margin = await fetchMargin(selectedMoeda);
        marginInput.value = margin !== null ? margin : parseFloat(defaultMarginValue).toFixed(2);
        generateProjection();
      } finally {
        hideLoading();
      }
    });

    ticksInput.addEventListener('input', () => {
      const inputValue = parseFloat(ticksInput.value);
      const selectedMoeda = moedaSelect.value;
      if (!isNaN(inputValue)) {
        if (selectedMoeda === 'USDJPY') { originalTicksValue = inputValue * 10; }
        else { originalTicksValue = inputValue; }
      } else { originalTicksValue = 0; }
      generateProjection();
    });

    marginInput.addEventListener("input", generateProjection);
    document.querySelector("#lotes").addEventListener("input", generateProjection);
    document.querySelector("#bankInput").addEventListener("input", generateProjection);
    document.querySelector("#daysInput").addEventListener("input", generateProjection);
    document.querySelector("#operationsInput").addEventListener("input", generateProjection);
    document.querySelector("#ticksInput").addEventListener("input", generateProjection);
    document.querySelector("#targetInput").addEventListener("input", generateProjection);
    document.querySelector("#recalculateOperationsInput").addEventListener("input", generateProjection);

    async function initialize() {
      showLoading();
      try {
        await fetchDollarRate();
        const margin = await fetchMargin(moedaSelect.value);
        marginInput.value = margin !== null ? margin : parseFloat(defaultMarginValue).toFixed(2);
        generateProjection();
      } finally {
        hideLoading();
      }
    }

    initialize();

    function toggleLanguageDropdown() {
      document.getElementById('languageDropdown').classList.toggle('show');
    }

    function changeLanguage(lang) {
      currentLanguage = lang;
      const t = translations[lang];
      document.getElementById('mainTitle').textContent = t.mainTitle;
      document.getElementById('bankLabel').textContent = t.bankLabel;
      document.getElementById('daysLabel').textContent = t.daysLabel;
      document.getElementById('operationsLabel').textContent = t.operationsLabel;
      document.getElementById('currencyLabel').textContent = t.currencyLabel;
      document.getElementById('ticksLabel').textContent = t.ticksLabel;
      document.getElementById('targetLabel').textContent = t.targetLabel;
      document.getElementById('marginLabel').textContent = t.marginLabel;
      document.getElementById('lotsLabel').textContent = t.lotsLabel;
      document.getElementById('recalculateLabel').textContent = t.recalculateLabel;
      document.getElementById('periodLabel').textContent = t.periodLabel;
      document.getElementById('finalBankLabel').textContent = t.finalBankLabel;
      document.getElementById('targetAchievedLabel').textContent = t.targetAchievedLabel;
      document.getElementById('tableTitle').textContent = t.tableTitle;
      document.getElementById('exportButtonText').textContent = t.exportButtonText;
      document.getElementById('loadingText').textContent = t.loadingText;
      document.getElementById('dayHeader').textContent = t.dayHeader;
      document.getElementById('initialBankHeader').textContent = t.initialBankHeader;
      document.getElementById('dailyProfitHeader').textContent = t.dailyProfitHeader;
      document.getElementById('profitPerOperationHeader').textContent = t.profitPerOperationHeader;
      document.getElementById('totalBankHeader').textContent = t.totalBankHeader;
      document.getElementById('totalBankBrlHeader').textContent = t.totalBankBrlHeader;
      document.getElementById('targetPercentageHeader').textContent = t.targetPercentageHeader;
      document.getElementById('operationsHeader').textContent = t.operationsHeader;
      document.getElementById('lotHeader').textContent = t.lotHeader;
      document.getElementById('ticksHeader').textContent = t.ticksHeader;

      const languageNames = { pt: 'Português', en: 'English', es: 'Español', fr: 'Français', de: 'Deutsch', it: 'Italiano', ru: 'Русский', zh: '中文' };
      document.getElementById('currentLanguage').textContent = languageNames[lang];
      const flags = { pt: '🇧🇷', en: '🇺🇸', es: '🇪🇸', fr: '🇫🇷', de: '🇩🇪', it: '🇮🇹', ru: '🇷🇺', zh: '🇨🇳' };
      document.querySelector('.language-btn .flag').textContent = flags[lang];

      document.querySelectorAll('.language-option').forEach(option => { option.classList.remove('active'); });
      document.querySelector(`[data-lang="${lang}"]`).classList.add('active');
      document.getElementById('languageDropdown').classList.remove('show');
      generateProjection();
    }

    document.addEventListener('click', function (event) {
      const dropdown = document.getElementById('languageDropdown');
      const button = document.querySelector('.language-btn');
      if (!dropdown.contains(event.target) && !button.contains(event.target)) {
        dropdown.classList.remove('show');
      }
    });

    function setTheme(theme) {
      if (theme === 'dark') {
        document.body.classList.add('dark-theme');
        document.getElementById('themeIcon').textContent = '☀️';
      } else {
        document.body.classList.remove('dark-theme');
        document.getElementById('themeIcon').textContent = '🌙';
      }
      localStorage.setItem('theme', theme);
    }
    function toggleTheme() {
      const isDark = document.body.classList.contains('dark-theme');
      setTheme(isDark ? 'light' : 'dark');
    }
    (function () {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') { setTheme('dark'); }
      else { setTheme('light'); }
    })();
  </script>
</body>

</html>
